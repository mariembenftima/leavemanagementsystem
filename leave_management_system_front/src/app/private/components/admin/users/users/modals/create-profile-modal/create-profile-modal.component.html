<div class="modal-backdrop" (click)="onClose()"></div>

<div class="modal-container" (click)="$event.stopPropagation()">
  <div class="modal-header">
    <div>
      <h3 class="modal-title">Create Employee Profile</h3>
      <p class="modal-subtitle">Complete the employee's profile information</p>
    </div>
    <button class="close-button" (click)="onClose()">
      <i class="bi bi-x-lg"></i>
    </button>
  </div>

  <div class="modal-body">
    <form (ngSubmit)="onSubmit()">
      <!-- Profile Picture Upload -->
      <div class="profile-picture-section">
        <div class="avatar-preview">
          <img
            *ngIf="previewUrl"
            [src]="previewUrl"
            alt="Profile preview"
            class="avatar-img"
          />
          <div *ngIf="!previewUrl" class="avatar-placeholder">
            {{ getInitials() }}
          </div>
          <button
            *ngIf="previewUrl"
            type="button"
            class="remove-avatar"
            (click)="removeProfilePicture()"
          >
            <i class="bi bi-x"></i>
          </button>
        </div>

        <label class="upload-button">
          <input
            type="file"
            accept="image/jpeg,image/jpg,image/png,image/webp"
            (change)="onFileSelected($event)"
            class="file-input"
          />
          <i class="bi bi-upload"></i>
          <span>Upload Profile Picture</span>
        </label>
        <p class="upload-hint">JPG, PNG, or WEBP. Max 5MB</p>
      </div>

      <!-- Employment Information Section -->
      <div class="section-title">
        <i class="bi bi-briefcase"></i>
        <span>Employment Information</span>
      </div>

      <div class="form-grid">
        <!-- Employee ID -->
        <div class="form-group">
          <label class="form-label">
            Employee ID <span class="required">*</span>
          </label>
          <div class="input-with-icon">
            <i class="bi bi-badge-tm"></i>
            <input
              type="text"
              [(ngModel)]="formData.employeeId"
              name="employeeId"
              class="form-control"
              placeholder="EMP001"
              required
            />
          </div>
        </div>

        <!-- Department -->
        <div class="form-group">
          <label class="form-label">
            Department <span class="required">*</span>
          </label>
          <div class="input-with-icon">
            <i class="bi bi-building"></i>
            <input
              type="text"
              [(ngModel)]="formData.department"
              name="department"
              class="form-control"
              placeholder="Engineering"
              required
            />
          </div>
        </div>

        <!-- Designation -->
        <div class="form-group">
          <label class="form-label">
            Designation <span class="required">*</span>
          </label>
          <div class="input-with-icon">
            <i class="bi bi-person-badge"></i>
            <input
              type="text"
              [(ngModel)]="formData.designation"
              name="designation"
              class="form-control"
              placeholder="Senior Developer"
              required
            />
          </div>
        </div>

        <!-- Join Date -->
        <div class="form-group">
          <label class="form-label">
            Join Date <span class="required">*</span>
          </label>
          <div class="input-with-icon">
            <i class="bi bi-calendar-check"></i>
            <input
              type="date"
              [(ngModel)]="formData.joinDate"
              name="joinDate"
              class="form-control"
              required
            />
          </div>
        </div>
      </div>

      <!-- Personal Information Section -->
      <div class="section-title">
        <i class="bi bi-person"></i>
        <span>Personal Information</span>
      </div>

      <div class="form-grid">
        <!-- Gender -->
        <div class="form-group">
          <label class="form-label">
            Gender <span class="required">*</span>
          </label>
          <div class="input-with-icon">
            <i class="bi bi-gender-ambiguous"></i>
            <select
              [(ngModel)]="formData.gender"
              name="gender"
              class="form-control"
              required
            >
              <option value="">Select Gender</option>
              <option *ngFor="let option of genderOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </div>
        </div>

        <!-- Date of Birth -->
        <div class="form-group">
          <label class="form-label">Date of Birth</label>
          <div class="input-with-icon">
            <i class="bi bi-calendar"></i>
            <input
              type="date"
              [(ngModel)]="formData.dateOfBirth"
              name="dateOfBirth"
              class="form-control"
            />
          </div>
        </div>

        <!-- Phone Number -->
        <div class="form-group">
          <label class="form-label">Phone Number</label>
          <div class="input-with-icon">
            <i class="bi bi-telephone"></i>
            <input
              type="tel"
              [(ngModel)]="formData.phone"
              name="phone"
              class="form-control"
              placeholder="+1 (555) 123-4567"
            />
          </div>
        </div>

        <!-- Marital Status -->
        <div class="form-group">
          <label class="form-label">Marital Status</label>
          <div class="input-with-icon">
            <i class="bi bi-heart"></i>
            <select
              [(ngModel)]="formData.maritalStatus"
              name="maritalStatus"
              class="form-control"
            >
              <option value="">Select Status</option>
              <option *ngFor="let option of maritalStatusOptions" [value]="option">
                {{ option }}
              </option>
            </select>
          </div>
        </div>

        <!-- Nationality -->
        <div class="form-group">
          <label class="form-label">Nationality</label>
          <div class="input-with-icon">
            <i class="bi bi-flag"></i>
            <input
              type="text"
              [(ngModel)]="formData.nationality"
              name="nationality"
              class="form-control"
              placeholder="American"
            />
          </div>
        </div>
      </div>

      <!-- Address -->
      <div class="form-group">
        <label class="form-label">Address</label>
        <div class="input-with-icon">
          <i class="bi bi-geo-alt"></i>
          <input
            type="text"
            [(ngModel)]="formData.address"
            name="address"
            class="form-control"
            placeholder="123 Main St, City, State, ZIP"
          />
        </div>
      </div>

      <!-- Emergency Contact Section -->
      <div class="section-title">
        <i class="bi bi-telephone-forward"></i>
        <span>Emergency Contact</span>
      </div>

      <div class="form-grid">
        <!-- Emergency Contact Name -->
        <div class="form-group">
          <label class="form-label">Emergency Contact Name</label>
          <div class="input-with-icon">
            <i class="bi bi-person-exclamation"></i>
            <input
              type="text"
              [(ngModel)]="formData.emergencyContactName"
              name="emergencyContactName"
              class="form-control"
              placeholder="Jane Doe"
            />
          </div>
        </div>

        <!-- Emergency Contact Phone -->
        <div class="form-group">
          <label class="form-label">Emergency Contact Phone</label>
          <div class="input-with-icon">
            <i class="bi bi-telephone-forward"></i>
            <input
              type="tel"
              [(ngModel)]="formData.emergencyContactPhone"
              name="emergencyContactPhone"
              class="form-control"
              placeholder="+1 (555) 987-6543"
            />
          </div>
        </div>
      </div>

      <!-- Financial Information Section -->
      <div class="section-title">
        <i class="bi bi-cash-coin"></i>
        <span>Financial Information</span>
      </div>

      <div class="form-grid">
        <!-- Salary -->
        <div class="form-group">
          <label class="form-label">Salary</label>
          <div class="input-with-icon">
            <i class="bi bi-currency-dollar"></i>
            <input
              type="number"
              [(ngModel)]="formData.salary"
              name="salary"
              class="form-control"
              placeholder="50000"
              step="0.01"
            />
          </div>
        </div>

        <!-- Bank Name -->
        <div class="form-group">
          <label class="form-label">Bank Name</label>
          <div class="input-with-icon">
            <i class="bi bi-bank"></i>
            <input
              type="text"
              [(ngModel)]="formData.bankName"
              name="bankName"
              class="form-control"
              placeholder="Chase Bank"
            />
          </div>
        </div>
      </div>

      <!-- Bank Account Number -->
      <div class="form-group">
        <label class="form-label">Bank Account Number</label>
        <div class="input-with-icon">
          <i class="bi bi-credit-card"></i>
          <input
            type="text"
            [(ngModel)]="formData.bankAccountNumber"
            name="bankAccountNumber"
            class="form-control"
            placeholder="1234567890"
          />
        </div>
      </div>
    </form>
  </div>

  <div class="modal-footer">
    <button
      type="button"
      class="btn btn-secondary"
      (click)="onClose()"
      [disabled]="loading"
    >
      Cancel
    </button>
    <button
      type="submit"
      class="btn btn-primary"
      (click)="onSubmit()"
      [disabled]="loading"
    >
      <span *ngIf="!loading">Create Profile</span>
      <span *ngIf="loading">
        <span class="spinner-border spinner-border-sm me-2"></span>
        Creating Profile...
      </span>
    </button>
  </div>
</div>